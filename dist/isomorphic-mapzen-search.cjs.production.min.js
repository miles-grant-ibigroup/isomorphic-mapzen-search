"use strict";var o=require("qs"),t=require("@conveyal/lonlat");"undefined"==typeof fetch&&require("isomorphic-fetch");const e="https://search.mapzen.com/v1/search";function r({apiKey:o,boundary:e,focusPoint:r,format:n,layers:a,options:c,sources:u="gn,oa,osm,wof",text:i,url:l="https://search.mapzen.com/v1/autocomplete"}){const m={api_key:o,text:i};if(u&&u.length>0&&(m.sources=u),a&&(m.layers=a),r){const{lat:o,lon:e}=t.normalize(r);m["focus.point.lat"]=o,m["focus.point.lon"]=e}return e&&(e.country&&(m["boundary.country"]=e.country),e.rect&&(m["boundary.rect.min_lat"]=e.rect.minLat,m["boundary.rect.min_lon"]=e.rect.minLon,m["boundary.rect.max_lat"]=e.rect.maxLat,m["boundary.rect.max_lon"]=e.rect.maxLon)),s({format:n,options:c,query:m,url:l})}function n({apiKey:o,boundary:r,focusPoint:n,format:a,options:c,size:u=10,sources:i="gn,oa,osm,wof",text:l,url:m=e}){if(!l)return Promise.resolve([]);const p={api_key:o,size:u,text:l};if(i&&i.length>0&&(p.sources=i),n){const{lat:o,lon:e}=t.normalize(n);p["focus.point.lat"]=o,p["focus.point.lon"]=e}return r&&(r.country&&(p["boundary.country"]=r.country),r.rect&&(p["boundary.rect.min_lat"]=r.rect.minLat,p["boundary.rect.min_lon"]=r.rect.minLon,p["boundary.rect.max_lat"]=r.rect.maxLat,p["boundary.rect.max_lon"]=r.rect.maxLon)),s({format:a,options:c,query:p,url:m})}function a({apiKey:o,format:e,options:r,point:n,url:a="https://search.mapzen.com/v1/reverse"}){const{lat:c,lon:u}=t.normalize(n);return s({format:e,options:r,query:{api_key:o,point:{lat:c,lon:u}},url:a})}function s({format:t=!1,options:r,query:n,url:a=e}){return fetch(`${a}?${o.stringify(n,{allowDots:!0})}`,r).then(o=>o.json()).then(o=>{let e=o;return o&&o.features&&t&&(e=o.features.map(c)),e.isomorphicMapzenSearchQuery=n,e})}function c({geometry:o,properties:e}){return Object.assign({},e,{address:`${e.label}${e.postalcode?" "+e.postalcode:""}`,latlng:t.fromCoordinates(o.coordinates)})}const u={autocomplete:r,reverse:a,search:n};exports.autocomplete=r,exports.default=u,exports.reverse=a,exports.search=n;
//# sourceMappingURL=isomorphic-mapzen-search.cjs.production.min.js.map
